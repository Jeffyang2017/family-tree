# 家族族谱生成器

这是一个基于 Web 的家族族谱生成器，允许用户通过上传 Excel 文件来创建和可视化家族关系。无需服务器支持，完全在浏览器端运行。

## 功能特点

- 支持从 Excel 文件导入家族数据
- 提供多种族谱样式（垂直、水平、经典、树形图）
- 支持公历和农历日期显示
- 可导出为 PNG 图片或 PDF 文档
- 支持选择任意家族成员作为族谱起点
- 完全在浏览器端运行，保护个人隐私

## 快速开始

### 安装和运行

```bash
# 克隆项目
git clone https://github.com/jeffyang2017/family-tree.git

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

也可以直接在浏览器中打开index.html文件使用（需要支持本地文件访问）。

### 使用方法

1. 准备一个包含以下列的 Excel 文件：
   - 人物ID (必填，唯一标识符，如 1, 2, 3...)
   - 姓名 (必填，如 "张三")
   - 性别 (必填，只能填 "男" 或 "女")
   - 父亲ID (可选，对应父亲的人物ID)
   - 母亲ID (可选，对应母亲的人物ID)
   - 配偶ID (可选，对应配偶的人物ID)
   - 出生日期 (可选，格式：YYYY-MM-DD 或 Excel日期格式)
   - 死亡日期 (可选，格式：YYYY-MM-DD 或 Excel日期格式)

2. 将 Excel 文件上传到应用
3. 从下拉列表中选择一个人作为族谱起点
4. 选择族谱样式和日期显示格式
5. 使用导出按钮将族谱保存为图片或 PDF

## Excel 文件格式详解

请按以下格式准备您的族谱数据Excel文件：

| 列名 | 必填 | 描述 | 示例 |
|------|-----|------|------|
| 人物ID | 是 | 唯一数字标识 | 1 |
| 姓名 | 是 | 人物姓名 | 张三 |
| 性别 | 是 | 男/女 | 男 |
| 父亲ID | 否 | 父亲的人物ID | 2 |
| 母亲ID | 否 | 母亲的人物ID | 3 |
| 配偶ID | 否 | 配偶的人物ID | 4 |
| 出生日期 | 否 | 公历日期 | 1980-01-01 |
| 死亡日期 | 否 | 公历日期 | 2020-12-31 |

### 示例数据

您可以下载[示例CSV模板文件](sample-template.csv)作为起点，或者参考以下示例内容：

```
人物ID  姓名    性别  父亲ID  母亲ID  配偶ID  出生日期     死亡日期
1      王大力   男    -      -      2      1930-01-15  2000-05-20
2      李小花   女    -      -      1      1935-03-22  2005-11-10
3      王建国   男    1      2      4      1955-07-08  -
4      张丽丽   女    -      -      3      1958-12-30  -
5      王小明   男    3      4      -      1980-10-05  -
6      王小红   女    3      4      -      1983-02-18  -
```

## 族谱样式说明

本应用提供四种不同的族谱展示样式：

1. **垂直样式**：从上到下展开的传统族谱，适合展示多代家族。
2. **水平样式**：从左到右展开，适合宽屏显示。
3. **经典样式**：传统中国族谱布局，强调辈分层级。
4. **树形图样式**：现代树状结构，清晰展示家族分支。

## 日期显示选项

- **公历**：显示公历日期 (如 1980年01月01日)
- **农历**：显示农历日期 (如 庚申年十二月初三)
- **公历和农历**：同时显示两种日期格式
- **不显示**：不显示日期信息

## 技术细节

- 前端框架：纯 HTML/CSS/JavaScript
- 开发环境：Vite.js
- 数据处理：Excel 文件解析使用 XLSX 库
- 图像生成：使用 html2canvas
- PDF 生成：使用 jsPDF
- 农历转换：lunar-javascript 库 (v1.7.2)

## 常见问题解答

1. **上传的Excel文件无法解析**
   - 确保Excel文件中包含所有必填列
   - 检查日期格式是否正确
   - 确保人物ID是唯一的

2. **农历日期显示不正确**
   - 农历转换支持1900年至2100年之间的日期
   - 确保原始日期格式正确

3. **导出PDF失败**
   - 如果使用的是离线环境，可能需要添加本地jsPDF库
   - 族谱过大时可能需要分页导出

4. **无法正确显示家族关系**
   - 检查父亲ID、母亲ID和配偶ID是否正确
   - 确认所有引用的ID在数据中都存在

## 浏览器兼容性

- Chrome 80+
- Firefox 75+
- Edge 80+
- Safari 13.1+

## 贡献指南

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 开启 Pull Request

## 开发者信息

- 项目维护者：[jeffyang2017](https://github.com/jeffyang2017)
- 联系方式：jeffyang2017@foxmail.com
- 许可证：MIT
